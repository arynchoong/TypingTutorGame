<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />
    <title>Typing Tutor Game</title>
        <link href="assets/css/style.css" rel="stylesheet">
        <script src="assets/js/script.js"></script>
</head>
<body>
    <div class="navbar" id="topNav">
        <a href="https://arynchoong.com" style="padding:0;"><img src="assets/images/aryn-straight.png"></a>
        <a href="../index.html">Typing Tutor</a>
        <div class="dropdown">
        <button class="dropbtn" onclick="addResponsive()">Game &#9662;</button>
        <div class="dropdown-content">
            <a href="py01_scrape_words.html">Scrape Words</a>
            <a href="py02_pygame.html">PyGame</a>
            <a href="py03_game_loop.html">Game Loop</a>
            <a href="py04_display_text.html">Text</a>
            <a class="active">Keypress</a>
            <a href="py06_game_object.html">Objects</a>
            <a href="py07_draw_playing.html">Play</a>
            <a href="py08_animate.html">Animate</a>
            <a href="py09_user_typing.html">Typing</a>
            <a href="py10_cityline.html">Cityline</a>
            <a href="py11_level_up.html">Levels</a>
            <a href="py12_sound.html">Sound</a>
            </div>
        </div>
        <a href="javascript:void(0);" class="icon" onclick="addResponsive()">&#9776;</a>
    </div>
    
    <div class="page">
    <article>
        <h1>Typing Tutor Game</h1>
        <h2>Detecting keypress event</h2>
        <p>To progress from one game state to another, we need to get user input.</p>
        <p>We check for the <code>KEYUP</code> event. We use the <code>KEYUP</code> event instead of <code>KEYPRESS</code> event, such that we don't register more than one event for when users long press of a key.</p>

        <div class="flex-container"><div class="box">
            <p>Let's wrap our event checking loop in a function:</p>
            <p>And in addition to our checking of <code>QUIT</code> event, we check for <code>KEYUP</code> event and increment the state or reset it if it is <code>GAMEOVER</code>.</p>
        </div><div class="boxes">
            <div class="code">
<pre><div class="diff">    <span class="k">def</span> <span class="f">on_check_event</span>(self):
</div>        <span class="k">for</span> event <span class="k">in</span> pygame.event.get():
            <span class="k">if</span> event.type <span class="ow">==</span> <span class="cn">QUIT</span>:
                self._running <span class="ow">=</span> <span class="k">False</span>
                self.state <span class="ow">=</span> <span class="cn">GAMEOVER</span>
<div class="diff">            <span class="k">elif</span> event.type <span class="ow">==</span> <span class="cn">KEYUP</span>:
                <span class="k">if</span> (self.state <span class="ow">==</span> <span class="cn">GAMEOVER</span>):
                    self.state <span class="ow">=</span> <span class="cn">START</span>
                <span class="k">else</span>:
                    self.state <span class="ow">+=</span> <span class="nb">1</span>
        <span class="k">return</span></div></pre></div>
</div></div>
<br>
<div class="flex-container"><div class="box">
<p>To display the different states, lets set different texts:</p>
</div><div class="boxes">
    <div class="code">
        <pre>    <span class="k">def</span> <span class="f">on_render</span>(self):
        '''Render surface'''
        self._display_surf.fill(<span class="cn">BLACK</span>)
<div class="diff">        
        # set the text for display
        if self.state == START:
            text = 'Typing Tutorial Game'
            message = 'Press space to play.'
        else:
            text = 'Game Over'
            message = 'State: %s' % self.state

        # draw the messages
        self.draw_text(text, GREEN, (WIDTH / 2, HEIGHT / 2 - 50))
        self.draw_text(message, GREEN, (WIDTH / 2, HEIGHT / 2 + 50))</div></pre></div>
</div></div>

<h2>Game Play</h2>
<div class="flex-container"><div class="box">
    <p>Now that we have our main loop, let us create our inner game play loop, where the playing of levels happen:</p>
</div><div class="boxes">
    <div class="code">
<pre># game.py
import pygame
<div class="diff">from play import GamePlay
</div> . 
 . 
 . 
class TypingTutor():
    def __init__(self):
        pygame.init() # initialises Pygame libraries
        self.screen = pygame.display.set_mode((WIDTH, HEIGHT))
        self.disp_surf = self.init_display()
        self.size = WIDTH, HEIGHT
        self.running = True if self.disp_surf else False
        self.state = START
        self.bigfont = pygame.font.Font('Consolas Bold.ttf', 36)
<div class="diff">        self.game = None
</div>        return
 . 
 . 
 . 
    def execute(self):
        # Event loop
        while self.running:
            self.check_event()
<div class="diff">            if self.state == PLAYING:
                self.game = GamePlay(self.screen)
                self.game.execute()
                self.state += 1
            else:
                self.render()
</div>        return
</pre></div></div></div>

<div class="flex-container"><div class="box">
<p>Let's create a new script, <b>play.py</b>.</p>
<p>So that we have a class to store our game play settings and status.</p>
</div><div class="boxes">
    <div class="code">
<pre><div class="diff"># play.py
</div>import pygame

# Colours        R    G    B
<div class="diff">BLUE        = (  0,   0, 128)
WHITE       = (255, 255, 255)

class GamePlay():
    def __init__(self, screen):
        self.screen = screen
</div>        pygame.init()
        self.disp_surf = pygame.Surface(self.screen.get_size()).convert()
        self.width, self.height = screen.get_size()
<div class="diff">        self.font =  pygame.font.Font('Consolas Bold.ttf', 16)
</div>        self.playing = True
        
    def execute(self):
        while self.playing:
            self.check_events()
<div class="diff">            self.loop()
</div>            self.render()
        return
    
    def check_events(self):
        for event in pygame.event.get():
            if event.type == pygame.QUIT:
                pygame.quit()
            elif event.type == pygame.KEYUP:
<div class="diff">                if event.key == pygame.K_ESCAPE:
                    self.playing = False
</div>        return
    
    def loop(self):
        pass
        
    def render(self):
        '''Render surface'''
<div class="diff">        self.disp_surf.fill(BLUE) # Fill background

        self.draw_text('Playing...', WHITE, (320, 240))
</div>        
        # Blit everything to screen
        self.screen.blit(self.disp_surf, (0,0))
        pygame.display.flip()
        return

    def draw_text(self, text, colour, center):
        # Display some text
        textsurf = self.font.render(text, True, colour)
        textrect = textsurf.get_rect()
        textrect.center = center
        self.disp_surf.blit(textsurf, textrect)
        return</pre></div>
</div></div>

    </article>
    </div>
    
    <div class="navbar-bottom">
        <a href="py04_display_text.html" class="nav-left">&#x2B05;</a>
        <a href="py06_game_object.html" class="nav-right">&#x27A1;</a>
    </div>
    <script src="assets/js/py_syntax_highlight.js"></script>
</body>
<footer>
    <p class="footer">Copyright Â© 2019 Aryn Choong. All Rights Reserved.</p>
</footer>
</html>